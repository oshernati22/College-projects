Building a graph + topological sorting
